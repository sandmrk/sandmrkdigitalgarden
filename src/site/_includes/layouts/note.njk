---
permalink: "notes/{{ page.fileSlug | slugify }}/"
---
<!DOCTYPE html>
<html lang="{{ meta.mainLanguage }}">
  <head>
    <title>{% if title %}{{ title }}{% else %}{{ page.fileSlug }}{% endif %}</title>
    {%include "components/pageheader.njk"%}
    {% for imp in dynamics.common.head %}
      {% include imp %}
    {% endfor %}
    {% for imp in dynamics.notes.head %}
      {% include imp %}
    {% endfor %}
  </head>
  <body class="theme-{{meta.baseTheme}} markdown-preview-view markdown-rendered markdown-preview-section {% if settings.dgShowFileTree !== true %}no-filetree{% endif %} {% if settings.dgHomeLink === true and settings.dgShowFileTree !== true %}has-navbar{% endif %} {{meta.bodyClasses}}">
    {%include "components/notegrowthhistory.njk"%}
    
    {% if settings.dgShowFileTree !== true %}
      {%include "components/navbar.njk"%}
    {%else%}
      {%include "components/filetree.njk"%}
    {% endif %}

    {% if settings.dgEnableSearch === true %}
      {%include "components/searchContainer.njk"%}
    {% endif %}

    <main class="content cm-s-obsidian {{contentClasses}}">
      <header>
        {% if settings.dgShowInlineTitle === true %}
          <h1 data-note-icon="{% if noteIcon %}{{noteIcon}}{% else %}{{meta.noteIconsSettings.default}}{% endif %}">{% if title %}{{ title }}{% else %}{{ page.fileSlug }}{% endif %}</h1>
        {% endif %}
        <div class="header-meta">
          {% if settings.dgShowTags === true and tags %}
            <div class="header-tags">
              {% for tag in tags %}
                {% if tag != 'gardenEntry' and tag !='note' %}
                  <a class="tag" onclick="toggleTagSearch(this)">
                    #{{tag}}
                  </a>
                {% endif %}
              {% endfor %}
            </div>
          {% endif %}
          {%- if meta.timestampSettings.showCreated or meta.timestampSettings.showUpdated -%}
          <div class="timestamps">
            {%- if meta.timestampSettings.showCreated and created -%}
            <div><i data-lucide="calendar-plus"></i> <span class="human-date" data-date="{{created}}"></span></div>
            {%- endif -%}
            {%- if meta.timestampSettings.showUpdated and updated -%}
            <div><i data-lucide="calendar-clock"></i> <span class="human-date" data-date="{{updated}}"></span></div>
            {%- endif -%}
          </div>
          {%- endif -%}
        </div>
      {% for imp in dynamics.common.header %}
        {% include imp %}
      {% endfor %}
      {% for imp in dynamics.notes.header %}
        {% include imp %}
      {% endfor %}
      </header>

      {% for imp in dynamics.notes.beforeContent %}
        {% include imp %}
      {% endfor %}
      {{ content | hideDataview | taggify | link | safe}}

      <button id="back-to-top" title="è¿”å›é¡¶éƒ¨">â†‘</button>

      <div id="cgfan-comments" style="margin-top: 50px;">
          <hr style="border:none; border-top:1px dashed #e8f5e9; margin-bottom: 30px;">
          <div id="waline"></div>
      </div>

      <link rel="stylesheet" href="https://unpkg.com/@waline/client@v3/dist/waline.css" />
      <script type="module">
        import { init } from 'https://unpkg.com/@waline/client@v3/dist/waline.js';

        // åˆå§‹åŒ– Waline (å·²å»æ‰ç™»å½•ç¦ç”¨ï¼Œæ¢å¤æ­£å¸¸ç™»å½•æ¨¡å¼)
        init({
          el: '#waline',
          serverURL: 'https://comments.cgfan.com',
          lang: 'zh-CN',
          reaction: true,
          dark: 'auto',
          placeholder: 'è¯·ç™»å½•åå‘è¡¨ä½ çš„è¯„è®º...',
        });

        // è¿”å›é¡¶éƒ¨é€»è¾‘
        const btt = document.getElementById('back-to-top');
        window.addEventListener('scroll', () => {
          btt.style.display = window.scrollY > 500 ? 'flex' : 'none';
        });
        btt.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
      </script>

      <style>
        /* ç»Ÿä¸€ç»¿è‰²é£æ ¼ */
        #back-to-top {
          position: fixed; bottom: 30px; right: 30px; width: 48px; height: 48px;
          border-radius: 50%; background-color: #4CAF50 !important; color: white !important;
          border: none; cursor: pointer; display: none; align-items: center; justify-content: center;
          box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3); z-index: 9999; font-size: 20px;
          transition: all 0.3s ease;
        }
        #back-to-top:hover { transform: translateY(-5px); background-color: #388E3C !important; }
        :root { --waline-theme-color: #4CAF50 !important; }
      </style>
      {% for imp in dynamics.common.afterContent %}
        {% include imp %}
      {% endfor %}
      {% for imp in dynamics.notes.afterContent %}
        {% include imp %}
      {% endfor %}
<script>
  (function() {
    const fixImages = () => {
      // å¯»æ‰¾æ‰€æœ‰å›¾ç‰‡æ ‡ç­¾
      const imgs = document.querySelectorAll('.markdown-rendered img, .content img');
      imgs.forEach(img => {
        const src = img.getAttribute('src');
        // æ£€æŸ¥æ˜¯å¦æ˜¯ X çš„å›¾ç‰‡é“¾æ¥ä¸”å°šæœªè¢«åä»£
        if (src && src.includes('twimg.com') && !src.includes('images.weserv.nl')) {
          // æ›¿æ¢ä¸ºåä»£é“¾æ¥ï¼Œä¿æŒåŸå§‹æ¸…æ™°åº¦
          const proxiedSrc = `https://images.weserv.nl/?url=${encodeURIComponent(src)}`;
          img.setAttribute('src', proxiedSrc);
          
          // å¤„ç†åŠ è½½å¤±è´¥çš„æƒ…å†µ
          img.onerror = function() {
            this.style.display = 'none'; // å¦‚æœåä»£ä¹ŸæŒ‚äº†ï¼Œéšè—åå›¾ï¼Œä¿æŒé¡µé¢æ•´æ´
          };
        }
      });
    };

    // åˆå§‹æ‰§è¡Œ
    fixImages();

    // é’ˆå¯¹ Digital Garden çš„åŠ¨æ€æ¸²æŸ“æœºåˆ¶ï¼Œæ¯éš” 1 ç§’å¤æ£€ä¸€æ¬¡ï¼ˆæ‰§è¡Œ 5 æ¬¡ï¼‰
    let checks = 0;
    const interval = setInterval(() => {
      fixImages();
      if (++checks >= 5) clearInterval(interval);
    }, 1000);
  })();
</script>
// æ„å»ºæ ‡ç­¾é¡µ
<div id="tag-page-logic-container"></div>

<script>
(function() {
    const isTagPage = window.location.pathname.includes('/tag/');
    if (!isTagPage) return;

    // 1. æ„å»ºæ ‡ç­¾é¡µçš„è§†è§‰ç»“æ„
    const params = new URLSearchParams(window.location.search);
    const targetTag = params.get('tag') || "æœªçŸ¥æ ‡ç­¾";
    
    // å¼ºåˆ¶æ¸…ç† note.njk åŸæœ‰çš„å†…å®¹ï¼Œæ›¿æ¢ä¸ºæˆ‘ä»¬çš„æ ‡ç­¾åˆ—è¡¨å®¹å™¨
    const mainContent = document.querySelector('main.content') || document.body;
    mainContent.innerHTML = `
        <div style="text-align:center; padding: 40px 0;">
            <div style="background:#e8f5e9; color:#4caf50; display:inline-block; padding:4px 12px; border-radius:20px; font-size:12px; font-weight:800;">SELECTION</div>
            <h1 style="margin:10px 0 !important; color:var(--cg-text-black);">#<span id="target-tag-name">${targetTag}</span></h1>
            <a href="/" style="color:#4caf50; text-decoration:none; font-weight:bold;">â† è¿”å›ç”»å»Šé¦–é¡µ</a>
        </div>
        <div id="tag-results-list" style="max-width:800px; margin:0 auto; padding:0 20px;">
            <p style="text-align:center; color:#999;">æ­£åœ¨ä»æ˜Ÿè¾°ä¸­æ±²å–åˆ›æ„...</p>
        </div>
    `;

    // 2. æ¸²æŸ“æ•°æ®
    const render = () => {
        const rawData = localStorage.getItem('cgfan_gallery_data');
        const container = document.getElementById('tag-results-list');
        if (!rawData) {
            container.innerHTML = `<div style="text-align:center; padding:50px;">è¯·å…ˆè®¿é—®<a href="/">é¦–é¡µ</a>åŒæ­¥æ•°æ®ã€‚</div>`;
            return;
        }

        const allPages = JSON.parse(rawData);
        const filtered = allPages.filter(p => p.tags && p.tags.includes(targetTag));
        
        let htmlRows = "";
        filtered.forEach(p => {
            const img = p.cover.includes('twimg.com') ? `https://images.weserv.nl/?url=${encodeURIComponent(p.cover)}&w=400` : p.cover;
            // å…¼å®¹æ€§è·¯å¾„å¤„ç†
            const slug = p.path.split('/').pop().replace('.md','');
            
            htmlRows += `
            <div style="display:flex; margin-bottom:20px; background:#fff; border:1px solid #eee; border-radius:16px; overflow:hidden; box-shadow:0 4px 10px rgba(0,0,0,0.03);">
                <div style="width:140px; height:140px; flex-shrink:0;">
                    <img src="${img}" style="width:100%; height:100%; object-fit:cover;">
                </div>
                <div style="padding:20px; flex-grow:1; display:flex; flex-direction:column; justify-content:center;">
                    <a href="/notes/${slug}/" style="font-weight:bold; color:#333; text-decoration:none; font-size:1.1rem; line-height:1.4;">${p.title}</a>
                    <div style="font-size:12px; color:#999; margin-top:8px;">ğŸ‘¤ ${p.author} | ğŸ“… ${p.created}</div>
                </div>
            </div>`;
        });
        container.innerHTML = filtered.length > 0 ? htmlRows : "å°šæœªå‘ç°ç›¸å…³çµæ„Ÿã€‚";
    };

    // 3. è§£å†³å•é¡µåº”ç”¨ä¸åˆ·æ–°çš„è½®è¯¢è¡¥ä¸
    render();
    const timer = setInterval(() => {
        if (document.getElementById('tag-results-list') && !document.querySelector('#tag-results-list div')) {
            render();
        }
    }, 1000);
    setTimeout(() => clearInterval(timer), 10000); // 10ç§’ååœæ­¢è½®è¯¢
})();
</script>
    </main>

    {% if settings.dgShowBacklinks === true or settings.dgShowLocalGraph === true or settings.dgShowToc === true%}
      {%include "components/sidebar.njk"%}
    {% endif %}

    {% if settings.dgLinkPreview === true %}
      {%include "components/linkPreview.njk"%}
    {% endif %}
    {% include "components/references.njk" %}
    {% include "components/timestamps.njk" %}
    {% for imp in dynamics.common.footer %}
      {% include imp %}
    {% endfor %}
    {% for imp in dynamics.notes.footer %}
      {% include imp %}
    {% endfor %}
    {%include "components/lucideIcons.njk"%}
    {% if contentClasses and "canvas-page" in contentClasses %}
      {%include "components/canvasScript.njk"%}
    {% endif %}
  </body>
</html>
