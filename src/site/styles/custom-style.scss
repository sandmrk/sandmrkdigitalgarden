/* ==========================================================================
   CGfan x Gemnana 终极 App UI 工业版 (2026-01-21 Ultimate Polish)
   设计语言：紧凑、精致、高信噪比、类原生 App 体验
   ========================================================================== */

/* --- 1. 核心变量体系 (System Variables) --- */
:root {
  color-scheme: light !important;
  /* 品牌色：极光绿 */
  --cg-green-vivid: #4CAF50;
  --cg-green-dark: #388E3C;
  --cg-green-light: #F1F8F1; /* 更纯净的淡绿背景 */
  
  /* 文字色：层级分明 */
  --cg-text-primary: #111827; /* 接近纯黑，高对比度 */
  --cg-text-secondary: #6B7280; /* 次级灰，柔和 */
  --cg-text-tertiary: #9CA3AF; /* 辅助灰 */
  
  /* 质感参数 */
  --card-radius: 16px; /* App 标准圆角 */
  --pill-radius: 100px; /* 胶囊圆角 */
  --app-shadow: 0 4px 20px rgba(0, 0, 0, 0.04); /* 空气感阴影 */
  --app-border: 1px solid rgba(0, 0, 0, 0.06); /* 极细描边 */
  
  /* 插件覆盖 */
  --accent: var(--cg-green-vivid) !important;
  --text-normal: var(--cg-text-primary) !important;
  --background-primary: #ffffff !important;
  --background-secondary: #fafafa !important;
  
  --dg-content-max-width: 960px !important; /* 略微放宽，增加通透感 */
}

/* --- 2. 全局排版 (Typography) --- */
html, body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, "PingFang SC", "Microsoft YaHei", sans-serif !important;
  font-size: 14px !important; /* App 通用基准字号 */
  line-height: 1.6 !important;
  color: var(--cg-text-primary) !important;
  background-color: #f9fafb !important; /* 全局背景微灰，突出卡片白 */
  -webkit-font-smoothing: antialiased;
}
* { font-feature-settings: "palt" 1 !important; letter-spacing: -0.01em !important; }

a { color: var(--cg-green-vivid) !important; text-decoration: none !important; transition: all 0.2s ease; }
a:hover { opacity: 0.8; }

/* --- 3. 顶部导航栏 (Glassmorphism) --- */
.header, .navbar {
  background-color: rgba(255, 255, 255, 0.85) !important;
  backdrop-filter: blur(20px) !important; /* iOS 毛玻璃强度 */
  -webkit-backdrop-filter: blur(20px) !important;
  border-bottom: 1px solid rgba(0,0,0,0.05) !important;
  height: 54px !important;
  position: fixed !important; top: 0; left: 0; right: 0; z-index: 1000 !important;
}
.header-title { 
  color: var(--cg-text-primary) !important; 
  font-weight: 700 !important; 
  font-size: 1.05rem !important;
  letter-spacing: -0.02em !important;
}
.search-button svg { fill: var(--cg-text-primary) !important; transform: scale(0.85); opacity: 0.8; }

/* --- 4. 侧边栏与布局 --- */
.filetree-wrapper, .sidebar { pointer-events: none !important; background: transparent !important; }
.filetree-sidebar a { pointer-events: auto !important; color: var(--cg-text-secondary) !important; font-size: 0.9rem !important; }
.filetree-sidebar a:hover { color: var(--cg-green-vivid) !important; background: var(--cg-green-light) !important; border-radius: 8px !important; }

/* --- 5. 内容容器 (紧凑化) --- */
.content, #content-container {
  max-width: 960px !important;
  padding: 90px 1rem 3rem !important; /* 移动端风格边距 */
  margin: 0 auto !important;
}

/* 页面标题 */
h1, .note-title { 
  color: var(--cg-text-primary) !important; 
  font-weight: 800 !important;
  font-size: 1.6rem !important; 
  line-height: 1.2 !important;
  margin-bottom: 1.2rem !important;
}

/* Banner 图片 */
img[src*="banner"] {
  width: 100% !important; height: 200px !important; object-fit: cover !important;
  border-radius: var(--card-radius) !important; margin-bottom: 1.5rem !important;
}

/* --- 6. 首页网格系统 (The Grid) --- */
.grid-view table {
  display: grid !important;
  grid-template-columns: repeat(4, 1fr) !important;
  gap: 12px !important; /* [紧凑] 间距缩小 */
  width: 100% !important; border: none !important; padding: 4px !important; margin: 0 !important;
}
.grid-view table thead { display: none !important; }
.grid-view table tbody { display: contents !important; }

/* 卡片本体 (App Card) */
.grid-view table tr {
  display: flex !important; flex-direction: column !important;
  background: #ffffff !important; 
  border: var(--app-border) !important;
  border-radius: var(--card-radius) !important;
  box-shadow: var(--app-shadow) !important;
  overflow: hidden !important;
  transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94), box-shadow 0.2s !important;
  margin: 0 !important;
}
.grid-view table tr:hover {
  transform: translateY(-4px) !important; 
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08) !important;
  border-color: rgba(76, 175, 80, 0.3) !important;
}

/* 单元格重置 */
.grid-view table td { display: block !important; border: none !important; padding: 0 !important; }

/* [区域1] 封面图 (4:3 黄金比例) */
.grid-view table td:first-child { height: 160px !important; position: relative !important; }
.grid-view table td:first-child img { 
  width: 100% !important; height: 100% !important; object-fit: cover !important; 
  border-radius: 0 !important; 
}
/* 图片蒙层优化 */
.grid-view table td:first-child::after {
  content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 40px;
  background: linear-gradient(to top, rgba(0,0,0,0.05), transparent); pointer-events: none;
}

/* [区域2] 标题 (精细排版) */
.grid-view table td:nth-child(2) { padding: 10px 12px 4px !important; }
.grid-view table td:nth-child(2) a { 
  font-size: 0.95rem !important; 
  font-weight: 700 !important; 
  color: var(--cg-text-primary) !important; 
  line-height: 1.4 !important;
  letter-spacing: -0.01em !important;
  display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
}

/* [区域3] Meta信息 (极简灰) */
.grid-view table td:nth-child(3), .grid-view table td:nth-child(4) { 
  padding: 0 12px !important; 
  font-size: 0.75rem !important; 
  color: var(--cg-text-tertiary) !important;
  font-weight: 500 !important;
  margin-top: 2px !important;
}

/* [区域4] 底部标签 (紧凑排列) */
.grid-view table td:last-child {
  display: flex !important; flex-wrap: wrap !important; gap: 6px !important;
  padding: 8px 12px 12px !important; margin-top: auto !important;
}
.grid-view td ul, .grid-view td li { display: contents !important; }
.grid-view td li::before { content: none !important; }

/* 卡片内标签 (微型胶囊) */
.grid-tag, .grid-view span[class*="tag"] {
  display: inline-flex !important; align-items: center !important;
  background-color: var(--cg-green-light) !important; 
  color: var(--cg-green-dark) !important;
  border: none !important; /* 去除边框，更现代 */
  border-radius: 6px !important; /* 微圆角 */
  padding: 2px 8px !important; 
  font-size: 0.7rem !important; 
  font-weight: 600 !important;
}

/* --- 7. 热门标签 (Hot Tags Pill) --- */
.markdown-rendered ul:has(.tag-group) {
  display: flex !important; flex-wrap: wrap !important; gap: 8px !important;
  list-style: none !important; padding: 0 !important; margin: 10px 0 24px 0 !important;
}
.markdown-rendered li:has(.tag-group) { display: contents !important; }

/* 热门标签：全圆角胶囊风格 */
.tag-group {
  display: inline-flex !important; align-items: center !important;
  background-color: #ffffff !important;
  border: 1px solid #e5e7eb !important;
  border-radius: var(--pill-radius) !important; /* 胶囊圆角 */
  padding: 4px 12px !important;
  transition: all 0.2s ease !important;
  box-shadow: 0 1px 2px rgba(0,0,0,0.02) !important;
}
.hot-tag-item { 
  color: var(--cg-text-primary) !important; 
  font-weight: 600 !important; font-size: 0.85rem !important; 
}
.hot-tag-count { 
  color: var(--cg-text-tertiary) !important; 
  font-size: 0.75rem !important; margin-left: 4px !important; 
}

.tag-group:hover {
  border-color: var(--cg-green-vivid) !important;
  background-color: var(--cg-green-light) !important;
  transform: translateY(-1px);
}
.tag-group:hover .hot-tag-item { color: var(--cg-green-dark) !important; }

/* --- 8. 加载按钮 (App CTA Button) --- */
.app-btn-style {
  background: linear-gradient(135deg, #4CAF50 0%, #43A047 100%) !important; /* 渐变绿 */
  color: #ffffff !important;
  border: none !important;
  border-radius: var(--pill-radius) !important;
  padding: 12px 36px !important;
  font-size: 0.95rem !important; font-weight: 600 !important;
  box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3) !important;
  cursor: pointer !important; transition: all 0.2s !important;
}
.app-btn-style:active { transform: scale(0.98) !important; box-shadow: 0 2px 6px rgba(76, 175, 80, 0.2) !important; }

/* --- 9. 内容页优化 (Clean Reading) --- */
.markdown-rendered img {
  border-radius: 12px !important; box-shadow: none !important; border: 1px solid rgba(0,0,0,0.03) !important;
}
.content > .markdown-rendered { display: flex !important; flex-direction: column !important; }
.markdown-rendered a.tag {
  order: -1 !important;
  background: transparent !important; border: none !important; padding: 0 !important;
  margin: 0 12px 8px 0 !important;
  font-size: 0.85rem !important; color: var(--cg-green-vivid) !important; font-weight: 600 !important;
}

/* --- 10. 响应式布局 (Mobile Compact) --- */
@media (max-width: 1100px) { .grid-view table { grid-template-columns: repeat(2, 1fr) !important; } }
@media (max-width: 600px) {
  .grid-view table { grid-template-columns: 1fr !important; }
  .grid-view table td:first-child { height: 200px !important; }
  .content { padding-top: 70px !important; padding-left: 1rem !important; padding-right: 1rem !important; }
  /* 手机端字体微调 */
  h1 { font-size: 1.4rem !important; }
}
